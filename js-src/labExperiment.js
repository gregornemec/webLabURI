// Experiment object ///////////////////////////////////////////////////////////
// labExperimnet.js

/*
 Description:

 * porabnike dobimo iz objekta Resistors.
 * animacija jakosti svetilnosti
 * menjava porabnikov z vleƒçenjem gradnika na mesto v toku krogu.
*/



//var currentResistor = "Global current";

function Experiment (pwrs) {

    var self = this;
    this.powerSupply = pwrs;
    console.log(pwrs);
    console.log(this.powerSupply);


    var circuitPP = [11.705, 5.320];
    //Image paths for experiment board ...
    var expNoInstImg = "./images/allExperimentBG/NoResistors.jpg";
    //caching image
    var expBGCache = new Image(1, 1);
    expBGCache.src = expNoInstImg;

    var expBoard = JXG.JSXGraph.initBoard('Experiment', {
        boundingbox: [0, 0, 14.96, 10.68],
        axis: false,
        grid: false,
        showCopyright: false,
        showNavigation: false
    });

    //Experiment BG image
    var expBG = expBoard.create('image',
                                [ expNoInstImg,
                                  [0, 10.68], [14.96, 10.68] ],
                                { fixed: true,
                                  frozen: true,
                                  opacity: 1,
                                  layer: 1 });


    //Creating circuit snap point.
    var circuitAttrPoint = expBoard.create('point', [circuitPP], {
        color: 'blue',
        size: 10,
        fixed: true,
        fillOpacity: 0,
        strokeOpacity: 0,
        name: "",
        visible: true,
        showInfoBox: false
        //attractorDistance: 0.4,
        //attractors: [this.rImg]
    });

    this.currentResistor = undefined;

    //Creating 100Ohm Resistor
    this.r100 = new Resistor( "R100",
                              //Resistance value from linear fit.
                              function (voltage) {return voltage/94.53;},
                              6.2,
                              expBoard,
                              expBG,
                              './images/r100B.png',
                              "red",
                              0.30, 2.19,
                              2.27, 2.13,
                              this.powerSupply,
                              circuitAttrPoint
                           );

    this.r100.createResistor(circuitAttrPoint);

    //Creating 500Ohm Resistor
    this.r500 = new Resistor( "R500",
                              function (voltage) {return voltage/472.9;},
                              6.5,
                              expBoard,
                              expBG,
                              './images/r500B.png',
                              "orange",
                              0.30, 4.33,
                              2.27, 2.13,
                              this.powerSupply,
                              circuitAttrPoint
                           );

    this.r500.createResistor(circuitAttrPoint);

    //Creating 3.5V bullb
    this.b35 = new Resistor( "B35",
                             200,   //Resistance from mesurment data!?
                             7.5,
                             expBoard,
                             expBG,
                             './images/B35B.png',
                             "blue",
                             0.30, 6.49,
                             2.27, 2.13,
                             this.powerSupply,
                             circuitAttrPoint
                           );
    this.b35.setImageFileList(
        'bullb35V/bullb35V_croped03.jpg',
        'bullb35V/bullb35V_croped04.jpg',
       // 'bullb35V/bullb35V_croped05.jpg',
        'bullb35V/bullb35V_croped06.jpg',
       // 'bullb35V/bullb35V_croped07.jpg',
        'bullb35V/bullb35V_croped08.jpg',
       // 'bullb35V/bullb35V_croped09.jpg',
        'bullb35V/bullb35V_croped10.jpg',
       //'bullb35V/bullb35V_croped11.jpg',
        'bullb35V/bullb35V_croped12.jpg',
       // 'bullb35V/bullb35V_croped13.jpg',
        'bullb35V/bullb35V_croped14.jpg',
       // 'bullb35V/bullb35V_croped15.jpg',
        'bullb35V/bullb35V_croped16.jpg',
       // 'bullb35V/bullb35V_croped17.jpg',
        'bullb35V/bullb35V_croped18.jpg',
       // 'bullb35V/bullb35V_croped19.jpg',
        'bullb35V/bullb35V_croped20.jpg',
       // 'bullb35V/bullb35V_croped21.jpg',
        'bullb35V/bullb35V_croped22.jpg',
        'bullb35V/bullb35V_croped23.jpg',
        'bullb35V/bullb35V_croped24.jpg'
    );

    //Reading real mesurmets of bullb.
    this.b35.readMeasurData(0.00686813186813,0.01221001221,0.0129731379731,0.026862026862,0.0169413919414,0.031746031746,0.0175518925519,0.041514041514,0.0190781440781,0.041514041514,0.0224358974359,0.0512820512821,0.0270146520147,0.0561660561661,0.0285409035409,0.0610500610501,0.0428876678877,0.0952380952381,0.0462454212454,0.114774114774,0.0535714285714,0.119658119658,0.0718864468864,0.197802197802,0.0758547008547,0.23199023199,0.07615995116,0.241758241758,0.0856227106227,0.40293040293,0.093253968254,0.529914529915,0.0941697191697,0.652014652015,0.0950854700855,0.774114774115,0.098137973138,0.788766788767,0.0999694749695,0.910866910867,0.10057997558,0.925518925519,0.100885225885,0.915750915751,0.102411477411,0.954822954823,0.102716727717,1.0231990232,0.103021978022,1.02808302808,0.108516483516,1.03296703297,0.108821733822,1.07692307692,0.109432234432,1.1452991453,0.110347985348,1.16483516484,0.113095238095,1.19413919414,0.114010989011,1.2967032967,0.115537240537,1.31623931624,0.116147741148,1.32112332112,0.117063492063,1.36996336996,0.118284493284,1.39438339438,0.118894993895,1.40415140415,0.120115995116,1.41391941392,0.120726495726,1.49206349206,0.121336996337,1.50183150183,0.121642246642,1.50671550672,0.121947496947,1.5115995116,0.122863247863,1.51648351648,0.124389499389,1.62393162393,0.126526251526,1.6336996337,0.126831501832,1.64835164835,0.1307997558,1.76068376068,0.13141025641,1.78021978022,0.13141025641,1.7851037851,0.135683760684,1.88766788767,0.135989010989,1.90231990232,0.136294261294,1.91697191697,0.1365995116,1.93650793651,0.137515262515,1.94627594628,0.140262515263,2,0.141178266178,2.02442002442,0.141788766789,2.03907203907,0.141788766789,2.06349206349,0.142704517705,2.08302808303,0.14300976801,2.0927960928,0.147588522589,2.20512820513,0.147893772894,2.2148962149,0.148199023199,2.21978021978,0.150641025641,2.30280830281,0.152472527473,2.34676434676,0.153388278388,2.3663003663,0.153388278388,2.37118437118,0.153388278388,2.37606837607,0.154609279609,2.3956043956,0.158577533578,2.52747252747,0.159188034188,2.54212454212,0.160409035409,2.56166056166,0.162851037851,2.64957264957,0.164377289377,2.68376068376,0.164682539683,2.69841269841,0.165598290598,2.70818070818,0.168956043956,2.81074481074,0.170177045177,2.8547008547,0.170482295482,2.8547008547,0.170787545788,2.91330891331,0.172619047619,2.91819291819,0.174145299145,2.96703296703,0.174145299145,2.98168498168,0.174450549451,2.98656898657,0.174450549451,2.99145299145,0.177197802198,3.08913308913,0.179945054945,3.16727716728,0.18025030525,3.18192918193,0.180860805861,3.1916971917,0.181166056166,3.19658119658,0.182387057387,3.23565323565,0.182692307692,3.26007326007,0.183913308913,3.28937728938,0.184523809524,3.29914529915,0.187576312576,3.36263736264,0.187881562882,3.37728937729,0.188492063492,3.42124542125,0.193681318681,3.61172161172,0.195207570208,3.62637362637,0.197954822955,3.71916971917,0.198870573871,3.75824175824,0.199786324786,3.8021978022,0.200091575092,3.81684981685,0.205280830281,3.90964590965,0.206501831502,4.02686202686,0.207722832723,4.03663003663,0.208028083028,4.0757020757,0.208333333333,4.10500610501,0.209249084249,4.11477411477,0.212606837607,4.23687423687,0.212912087912,4.24175824176,0.213522588523,4.24664224664,0.213827838828,4.27106227106,0.214133089133,4.28571428571,0.216575091575,4.38827838828,0.218101343101,4.42735042735,0.218406593407,4.43711843712,0.219017094017,4.442002442,0.219322344322,4.46642246642,0.219932844933,4.48595848596,0.220238095238,4.49572649573,0.220848595849,4.5641025641,0.222374847375,4.60805860806,0.226648351648,4.71062271062,0.227564102564,4.72039072039,0.22847985348,4.778998779,0.230006105006,4.87179487179,0.232448107448,4.91086691087,0.233058608059,4.9304029304,0.233974358974,4.98901098901,0.236721611722,5.06715506716,0.237332112332,5.08180708181,0.238247863248,5.10134310134,0.240995115995,5.21855921856,0.241910866911,5.23321123321,0.243131868132,5.28693528694,0.243437118437,5.2967032967,0.243742368742,5.33577533578,0.245268620269,5.39926739927,0.245879120879,5.40415140415,0.247710622711,5.5115995116,0.248626373626,5.57020757021,0.248931623932,5.57509157509,0.249847374847,5.63858363858,0.250763125763,5.69719169719,0.251068376068,5.70207570208,0.251373626374,5.7557997558,0.251678876679,5.78998778999,0.251984126984,5.83882783883,0.252289377289,5.9072039072,0.252594627595,5.94139194139,0.2528998779,6.00976800977,0.254731379731,6.11721611722,0.256257631258,6.12698412698,0.257478632479,6.18559218559,0.257783882784,6.20024420024,0.262973137973,6.2735042735,0.264194139194,6.30769230769,0.264804639805,6.31746031746,0.265415140415,6.32722832723,0.26572039072,6.33211233211,0.267551892552,6.3663003663,0.267857142857,6.37606837607,0.271825396825,6.44932844933,0.276709401709,6.4884004884,0.282509157509,6.52258852259,0.284951159951,6.53235653236,0.298076923077,6.60073260073,0.338675213675,6.68376068376,0.381715506716,6.7326007326,0.444291819292,6.80097680098,0.454365079365,6.81562881563,0.456501831502,6.82051282051,0.47268009768,6.85958485958,0.473290598291,6.86446886447,0.473901098901,6.86935286935,0.475427350427,6.87423687424,0.475732600733,6.87912087912,0.476953601954,6.884004884);


    this.b35.createResistor(circuitAttrPoint);

    //Creating 12V bullb
    this.b12 = new Resistor( "B12",
                             50,   //Resistance from mesurment data!?
                             24,
                             expBoard,
                             expBG,
                             './images/B12B.png',
                             "violet",
                             0.15, 8.75,
                             2.61, 2.41,
                             this.powerSupply,
                             circuitAttrPoint
                           );
    this.b12.setImageFileList(
        'bullb12V/bullb12V_croped000.jpg',
        'bullb12V/bullb12V_croped001.jpg',
        //'bullb12V/bullb12V_croped002.jpg',
        //'bullb12V/bullb12V_croped003.jpg',
        'bullb12V/bullb12V_croped004.jpg',
        //'bullb12V/bullb12V_croped005.jpg',
        //'bullb12V/bullb12V_croped006.jpg',
        'bullb12V/bullb12V_croped007.jpg',
        //'bullb12V/bullb12V_croped008.jpg',
        //'bullb12V/bullb12V_croped009.jpg',
        'bullb12V/bullb12V_croped010.jpg',
        //'bullb12V/bullb12V_croped011.jpg',
        //'bullb12V/bullb12V_croped012.jpg',
        'bullb12V/bullb12V_croped013.jpg',
        //'bullb12V/bullb12V_croped014.jpg',
        //'bullb12V/bullb12V_croped015.jpg',
        'bullb12V/bullb12V_croped016.jpg',
        //'bullb12V/bullb12V_croped017.jpg',
        //'bullb12V/bullb12V_croped018.jpg',
        'bullb12V/bullb12V_croped019.jpg',
        //'bullb12V/bullb12V_croped020.jpg',
        //'bullb12V/bullb12V_croped021.jpg',
        'bullb12V/bullb12V_croped022.jpg',
        //'bullb12V/bullb12V_croped023.jpg',
        //'bullb12V/bullb12V_croped024.jpg',
        'bullb12V/bullb12V_croped025.jpg',
        //'bullb12V/bullb12V_croped026.jpg',
        //'bullb12V/bullb12V_croped027.jpg',
        'bullb12V/bullb12V_croped028.jpg',
        //'bullb12V/bullb12V_croped029.jpg',
        //'bullb12V/bullb12V_croped030.jpg',
        'bullb12V/bullb12V_croped031.jpg',
        //'bullb12V/bullb12V_croped032.jpg',
        //'bullb12V/bullb12V_croped033.jpg',
        'bullb12V/bullb12V_croped034.jpg'
        );

    //Cleaner measurments!
    this.b12.readMeasurData(0.02,0.01,0.43,0.15,0.72,0.42,0.58,0.45,0.69,0.56,0.91,0.81,1.08,1.15,1.33,1.31,1.4,1.55,1.58,1.83,1.76,2.16,1.79,2.21,1.88,2.48,2.03,2.82,2.11,3.05,2.26,3.46,2.47,3.92,2.57,4.28,2.75,4.78,2.82,4.82,2.92,5.21,3.01,5.53,3.1,5.85,3.2,6.19,3.27,6.39,3.31,6.59,3.42,6.91,3.56,7.41,3.58,7.52,3.63,7.69,3.64,7.75,3.74,8.08,3.8,8.21,3.78,8.22,3.81,8.41,3.87,8.58,3.91,8.85,3.96,9,4,9.1,4.01,9.18,4.04,9.36,4.06,9.44,4.1,9.53,4.15,9.88,4.16,9.89,4.19,9.95,4.23,10.18,4.36,10.75,4.38,10.84,4.44,11.03,4.56,11.47,4.59,11.79,4.66,11.92,4.67,12.13,4.71,12.22,4.72,12.25,4.73,12.25,4.74,12.28,4.79,12.47,4.85,12.77,4.87,12.87,4.9,13.04,4.9,13.06);

    this.b12.createResistor(circuitAttrPoint);
}
